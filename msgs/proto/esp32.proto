syntax = "proto3";

package larcs.msgs;

import "common.proto";

// PC → ESP32 command
message ESP32Command {
  Header header = 1;
  
  enum Mode {
    DISARM = 0;   // Motor disabled
    ARM = 1;      // Motor enabled
    ESTOP = 2;    // Emergency stop
  }
  Mode mode = 2;
  
  // Wheel speed target [RPM] (supports up to 4 wheels)
  repeated double wheel_rpm_target = 3;
  
  // Timeout [ms] (stop if next command doesn't arrive within this time)
  uint32 ttl_ms = 4;
}

// ESP32 → PC state
message ESP32State {
  Header header = 1;
  
  // Encoder accumulated value [ticks]
  repeated int64 encoder_ticks = 2;
  
  // Estimated wheel speed [RPM]
  repeated double wheel_rpm = 3;
  
  // Battery voltage [V]
  double battery_voltage = 4;
  
  // E-stop button pressed state
  bool estop_pressed = 5;
  
  // ESP32 uptime [ms]
  uint32 uptime_ms = 6;
  
  // Motor driver errors
  repeated string errors = 7;
}
